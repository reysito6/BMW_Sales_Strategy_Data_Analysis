<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="bmwtable.csv" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="1119"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="bmw sales" custom_title="0" dock_id="1" table="4,9:mainbmw sales"/><dock_state state="000000ff00000000fd0000000100000002000001e9000002d3fc0100000001fb000000160064006f0063006b00420072006f00770073006500310100000000000001e90000013900ffffff000001e90000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="bmw sales" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="71"/><column index="2" value="39"/><column index="3" value="111"/><column index="4" value="55"/><column index="5" value="79"/><column index="6" value="103"/><column index="7" value="111"/><column index="8" value="87"/><column index="9" value="79"/><column index="10" value="103"/><column index="11" value="167"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">-- Query 1: IDENTIFICACIÓN Y CONTEO COMPLETO DE VALORES NULOS (Data Quality Audit)
-- Objetivo: Crear un reporte de una sola fila para auditar la integridad de las 11 columnas.

SELECT
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field1 IS NULL) AS Nulos_Modelo,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field2 IS NULL) AS Nulos_Anio,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field3 IS NULL) AS Nulos_Region,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field4 IS NULL) AS Nulos_Color,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field5 IS NULL) AS Nulos_Tipo_Combustible,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field6 IS NULL) AS Nulos_Transmision,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field7 IS NULL) AS Nulos_Tamano_Motor,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field8 IS NULL) AS Nulos_Kilometraje,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field9 IS NULL) AS Nulos_Precio_USD,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field10 IS NULL) AS Nulos_Volumen_Ventas,
    (SELECT COUNT(*) FROM &quot;bmw sales&quot; WHERE field11 IS NULL) AS Nulos_Clasificacion
FROM
    &quot;bmw sales&quot;
LIMIT 1; -- Limitamos a 1 para asegurar que solo devuelva una fila de resultados

-- Query 2: Comprobación de Integridad: Búsqueda de Registros Duplicados
-- Agrupamos por TODAS las características clave para filtrar las anomalías de registro.
SELECT
    field1 AS Modelo,
    field2 AS Año,
    field3 AS Región,
    field4 AS Color,
    field9 AS Precio_USD,
    COUNT(*) AS Frecuencia_Duplicada
FROM
    &quot;bmw sales&quot;
GROUP BY
    field1, field2, field3, field4, field9, field5, field6, field7, field8, field10, field11
HAVING
    COUNT(*) &gt; 1; -- Filtra las anomalías
	
	-- Query 3: Ranking de Ingresos Totales por Modelo y Región
-- Muestra las combinaciones más rentables para la estrategia de ventas.
SELECT
    field1 AS Modelo,
    field3 AS Region,
    SUM(field9 * field10) AS Ingreso_Total_USD, -- Cálculo crucial: Precio * Volumen
    SUM(field10) AS Total_Unidades_Vendidas
FROM
    &quot;bmw sales&quot;
WHERE
    field9 IS NOT NULL AND field10 IS NOT NULL
GROUP BY
    field1, field3
ORDER BY
    Ingreso_Total_USD DESC
LIMIT 10; -- Los 10 segmentos más rentables

-- Query 4: Análisis de Precio Promedio por Tipo de Transmisión
-- Identifica qué tipo de vehículo (según su transmisión) se vende al precio más alto.
SELECT
    field6 AS Tipo_Transmision,
    field7 AS Tamano_Motor,
    CAST(AVG(field9) AS INTEGER) AS Precio_Promedio_Venta_USD,
    SUM(field10) AS Unidades_Vendidas
FROM
    &quot;bmw sales&quot;
WHERE
    field9 IS NOT NULL
GROUP BY
    field6, field7
ORDER BY
    Precio_Promedio_Venta_USD DESC;</sql><current_tab id="0"/></tab_sql></sqlb_project>
